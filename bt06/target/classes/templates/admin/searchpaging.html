<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layout-admin}">

<div layout:fragment="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>üîç T√¨m ki·∫øm & Ph√¢n trang</h2>
        <a th:href="@{/admin/categories}" class="btn btn-outline-primary">üìã Danh s√°ch ƒë·∫ßy ƒë·ªß</a>
    </div>

    <!-- Form t√¨m ki·∫øm -->
    <div class="card mb-4">
        <div class="card-body">
            <form th:action="@{/admin/categories/search}" method="get" class="row g-3">
                <div class="col-md-8">
                    <input type="text" class="form-control" name="name" 
                           th:value="${name}" placeholder="Nh·∫≠p t√™n danh m·ª•c ƒë·ªÉ t√¨m ki·∫øm...">
                </div>
                <div class="col-md-2">
                    <select name="size" class="form-select" onchange="this.form.submit()">
                        <option value="5" th:selected="${categoryPage.size == 5}">5 b·∫£n ghi/trang</option>
                        <option value="10" th:selected="${categoryPage.size == 10}">10 b·∫£n ghi/trang</option>
                        <option value="20" th:selected="${categoryPage.size == 20}">20 b·∫£n ghi/trang</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary w-100">üîç T√¨m ki·∫øm</button>
                </div>
            </form>
        </div>
    </div>

    <!-- K·∫øt qu·∫£ t√¨m ki·∫øm -->
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="card-title mb-0">K·∫øt qu·∫£ t√¨m ki·∫øm</h5>
            <span class="badge bg-info" th:text="'T·ªïng s·ªë: ' + ${categoryPage.totalElements} + ' b·∫£n ghi'"></span>
        </div>
        <div class="card-body">
            <!-- Th√¥ng b√°o kh√¥ng c√≥ k·∫øt qu·∫£ -->
            <div th:if="${categoryPage.empty}" class="alert alert-warning">
                <strong>Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o!</strong> 
                <span th:if="${name}">V·ªõi t·ª´ kh√≥a: "<span th:text="${name}"></span>"</span>
                <a th:href="@{/admin/categories}" class="alert-link"> Xem t·∫•t c·∫£ danh m·ª•c</a>
            </div>

            <!-- B·∫£ng k·∫øt qu·∫£ -->
            <div th:unless="${categoryPage.empty}" class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>T√™n Danh m·ª•c</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="category : ${categoryPage.content}">
                            <td th:text="${category.categoryId}"></td>
                            <td th:text="${category.name}"></td>
                            <td>
                                <a th:href="@{/admin/categories/edit/{id}(id=${category.categoryId})}" 
                                   class="btn btn-warning btn-sm">‚úèÔ∏è S·ª≠a</a>
                                <a th:href="@{/admin/categories/delete/{id}(id=${category.categoryId})}" 
                                   class="btn btn-danger btn-sm"
                                   onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a?')">üóëÔ∏è X√≥a</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Ph√¢n trang -->
            <div th:if="${categoryPage.totalPages > 1}" class="mt-4">
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                        <!-- First page -->
                        <li class="page-item" th:classappend="${categoryPage.number == 0} ? 'disabled'">
                            <a class="page-link" th:href="@{/admin/categories/search(name=${name}, size=${categoryPage.size}, page=0)}">ƒê·∫ßu</a>
                        </li>
                        
                        <!-- Previous page -->
                        <li class="page-item" th:classappend="${categoryPage.number == 0} ? 'disabled'">
                            <a class="page-link" th:href="@{/admin/categories/search(name=${name}, size=${categoryPage.size}, page=${categoryPage.number - 1})}">Tr∆∞·ªõc</a>
                        </li>
                        
                        <!-- Page numbers -->
                        <li th:each="pageNumber : ${#numbers.sequence(0, categoryPage.totalPages - 1)}" 
                            class="page-item" th:classappend="${pageNumber == categoryPage.number} ? 'active'">
                            <a class="page-link" 
                               th:href="@{/admin/categories/search(name=${name}, size=${categoryPage.size}, page=${pageNumber})}"
                               th:text="${pageNumber + 1}"></a>
                        </li>
                        
                        <!-- Next page -->
                        <li class="page-item" th:classappend="${categoryPage.number == categoryPage.totalPages - 1} ? 'disabled'">
                            <a class="page-link" th:href="@{/admin/categories/search(name=${name}, size=${categoryPage.size}, page=${categoryPage.number + 1})}">Sau</a>
                        </li>
                        
                        <!-- Last page -->
                        <li class="page-item" th:classappend="${categoryPage.number == categoryPage.totalPages - 1} ? 'disabled'">
                            <a class="page-link" th:href="@{/admin/categories/search(name=${name}, size=${categoryPage.size}, page=${categoryPage.totalPages - 1})}">Cu·ªëi</a>
                        </li>
                    </ul>
                </nav>
                
                <div class="text-center text-muted">
                    Trang <span th:text="${categoryPage.number + 1}"></span> 
                    / <span th:text="${categoryPage.totalPages}"></span>
                    - Hi·ªÉn th·ªã <span th:text="${categoryPage.size}"></span> b·∫£n ghi/trang
                </div>
            </div>
        </div>
    </div>
</div>
</html>